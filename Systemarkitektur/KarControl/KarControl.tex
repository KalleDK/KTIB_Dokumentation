%!TEX root = ../../main.tex

\subsection{KarControl BDD}
\systemBDD{0.82}{KarControl}

\subsubsection{KarGruppe}
KarGruppe er den overordnede betegnelse for et vandkar med tilførende pH-værdi og gødningskoncentration. KarGruppen består af diverse sensorer og aktuatorer, og styrer et vilkårligt antal Sensor Ø’er. KarGruppen er styret af en controller, KarControl.

\subsubsection{Indløbsventil}
Indløbsventilen åbner og lukker for vandtilføjelsen til karret. Den bruges i forbindelse med, at der skal fyldes vand på karret. Det antages, at indløbsventilen er tilsluttet en vandforsyning, som altid er åben.

\subsubsection{Afløbsventil}
Afløbsventilen åbner og lukker for, at vand kan løbe ud af karret. Den bruges i forbindelse med, at karret skal tømmes.

\subsubsection{pH-Sensor}
pH-sensoren målet pH-værdien af gødningsblandingen i karret.

\subsubsection{Vandpumpe}
Vandpumpen pumper vand fra karret ud til Sensor Ø’erne.

\subsubsection{Flowmåler}
Flowmåleren måler mængden af vand, som tilføres karret gennem Indløbsventilen.

\subsection{KarControl IBD}
\systemIBD{0.82}{KarControl}{KarControl}

\subsubsection{RSIn}
RSConverter konverterer mellem RS485 og UART 232 når der skal kommunikeres med CentralControl.

\subsubsection{RSOut}
RSConverter konverterer mellem RS485 og UART 232 når der skal kommunikeres med Sensor Ø'er.

%\subsection{KarControl Allokeringsdiagram}
%\systemAllokeringsDiagram{0.82}{KarControl}{KarControl}

\subsection{Signalbeskrivelser KarControl}
\systemSignaler{KarControl} {
KarBus				& RS485 bus til kommunikation mellem enheder & Binary 1 (OFF)
																   (Voa-Vob<-200 mV)
																   Binary 0 (ON)
																  (Voa-Vob>+200 mV)	 	& Differentielt bussystem \\
OeBus				& RS485 bus til kommunikation mellem enheder & Binary 1 (OFF)
																   (Voa-Vob<-200 mV)
																   Binary 0 (ON)
																  (Voa-Vob>+200 mV)	 	& Differentielt bussystem \\
Data485				& RS485 bus til kommunikation mellem enheder & Intern:SW-signal		& Internt signal fra RSconverter til KarGruppe \\
Data232				& RS485 konverteret til logisk niveau		 & Intern:SW-signal 	& Konverteret signal fra RSconverter til Controller  \\
EnableIndløb		& Signal til at lukke vand ind i kar		 & Logisk:0-5V			& Signal til styring af Indløbsventil   \\
EnableAfløb			& Signal til at lukke vand ud af kar		 & Logisk:0-5V			& Signal til styring af Afløbsventil   \\
EnableVandpumpe		& Signal til styring Vandpumpe		   	     & Logisk:PWM 0-5V 		& Signal til PWM-styring af Vandpumpe	\\
Puls				& Takttæller af flow				   	 	 & Logisk:0-5V 			& Retursignal fra flowtæller \\
pH					& Analog signal fra pH måler			 	 & Analog:-420mV-420mV  & Analogt sensorsignal \\
Indløb				& vandstyring i kar							 & Vandflow   			& Vandtilførsel til karret \\
Afløb				& vandstyring i kar	 						 & Vandflow  			& Vandtilafledning fra karret \\
Dossering			& vandstyring til planter					 & Vandflow    			& Vandtilførsel til dosering \\
}